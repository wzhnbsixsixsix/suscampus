{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="{% static 'bootstrap/css/bootstrap.min.css' %}"
      rel="stylesheet"
    />
    <title>Create Announcement</title>
  </head>
  <body>
    {% include 'navbar.html' %}

    <div class="container mt-4">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <h1 class="mb-4">Create a New Announcement</h1>
          <form method="POST" enctype="multipart/form-data" class="border p-4 rounded-3 bg-light">
            {% csrf_token %}
            
            <!-- Title Field -->
            <div class="mb-3">
              <label for="id_title" class="form-label">Title</label>
              <input type="text" 
                     class="form-control {% if form.title.errors %}is-invalid{% endif %}" 
                     id="id_title" 
                     name="title" 
                     value="{{ form.title.value|default:'' }}">
              {% for error in form.title.errors %}
                <div class="invalid-feedback">
                  {{ error }}
                </div>
              {% endfor %}
            </div>

            <!-- Summary Field -->
            <div class="mb-3">
              <label for="id_summary" class="form-label">Summary</label>
              <input type="text" 
                     class="form-control {% if form.summary.errors %}is-invalid{% endif %}" 
                     id="id_summary" 
                     name="summary" 
                     value="{{ form.summary.value|default:'' }}">
              {% for error in form.summary.errors %}
                <div class="invalid-feedback">
                  {{ error }}
                </div>
              {% endfor %}
            </div>

            <!-- Content Field -->
            <div class="mb-3">
              <label for="id_content" class="form-label">Content</label>
              <textarea class="form-control {% if form.content.errors %}is-invalid{% endif %}" 
                        id="id_content" 
                        name="content" 
                        rows="5">{{ form.content.value|default:'' }}</textarea>
              {% for error in form.content.errors %}
                <div class="invalid-feedback">
                  {{ error }}
                </div>
              {% endfor %}
            </div>

            <!-- Image Upload -->
            <div class="mb-4">
              <label for="id_image" class="form-label">Upload Image</label>
              <input type="file" 
                     class="form-control {% if form.image.errors %}is-invalid{% endif %}" 
                     id="id_image" 
                     name="image" 
                     accept="image/*">
              {% for error in form.image.errors %}
                <div class="invalid-feedback">
                  {{ error }}
                </div>
              {% endfor %}
            </div>

            <!-- Is Event Checkbox -->
            <div class="mb-3 form-check">
              <input type="checkbox" 
                     class="form-check-input" 
                     id="id_is_event" 
                     name="is_event"
                     {% if form.is_event.value %}checked{% endif %}>
              <label class="form-check-label" for="id_is_event">Is this an event?</label>
              {% for error in form.is_event.errors %}
                <div class="invalid-feedback d-block">
                  {{ error }}
                </div>
              {% endfor %}
            </div>

            <!-- Event Fields (Initially Hidden) -->
            <div id="eventFields" style="display: none;">
              <!-- Currency Reward -->
              <div class="mb-3">
                <label for="id_currency_reward" class="form-label">Currency Reward</label>
                <input type="number" 
                      class="form-control {% if form.currency_reward.errors %}is-invalid{% endif %}" 
                      id="id_currency_reward" 
                      name="currency_reward" 
                      value="{{ form.currency_reward.value|default:'' }}">
                {% for error in form.currency_reward.errors %}
                  <div class="invalid-feedback">
                    {{ error }}
                  </div>
                {% endfor %}
              </div>

              <!-- Transaction Description -->
              <div class="mb-3">
                <label for="id_transaction_description" class="form-label">Transaction Description</label>
                <textarea class="form-control {% if form.transaction_description.errors %}is-invalid{% endif %}" 
                          id="id_transaction_description" 
                          name="transaction_description" 
                          rows="3">{{ form.transaction_description.value|default:'' }}</textarea>
                {% for error in form.transaction_description.errors %}
                  <div class="invalid-feedback">
                    {{ error }}
                  </div>
                {% endfor %}
              </div>

              <!-- Event Date -->
              <div class="mb-3">
                <label for="id_event_date" class="form-label">Event Date</label>
                <input type="date" 
                      class="form-control {% if form.event_date.errors %}is-invalid{% endif %}" 
                      id="id_event_date" 
                      name="event_date" 
                      value="{{ form.event_date.value|default:'' }}">
                {% for error in form.event_date.errors %}
                  <div class="invalid-feedback">
                    {{ error }}
                  </div>
                {% endfor %}
              </div>
            </div>

            <!-- Buttons -->
            <div class="d-flex gap-3">
                <button type="submit"class="btn btn-primary px-4">Submit</button>
            </form>
        <a href="{% url 'announcements:announcement_list' %}">Back to Announcements</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="{% static 'bootstrap/js/bootstrap.bundle.min.js' %}"></script>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const eventCheckbox = document.getElementById('id_is_event');
        const eventFields = document.getElementById('eventFields');

        function toggleEventFields() {
          eventFields.style.display = eventCheckbox.checked ? 'block' : 'none';
        }

        // Initial check
        toggleEventFields();
        
        // Add event listener
        eventCheckbox.addEventListener('change', toggleEventFields);
      });
    </script>
  </body>
</html>

